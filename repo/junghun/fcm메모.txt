클라이언트 초기화
firebase.js - 
.env파일에서 환경변수 (API KEY, Project ID등)를 읽어 Firebase앱을 초기화하고 messaging 인스턴스 생성

권한요청 
App.vue
onMounted또는 버튼 클릭시  Nofcation.requestPermission()을 호출하여 사용자에게 알림 권한을 요청합니다.

토큰 발급
App.vue
권한 허용후 getToken(messaging,{...}을 호출합니다. Firebase는 이 요청을 받아 해당 브라우저에 고유한 FCM 등록 토큰을 발급합니다.

백앤드 전송
App.vue 
saveTokenToServer(token) 함수가 axios.post를 사용하여 발급받은 토큰을 백엔드 서버로 전송합니다. (application.properties에서 cors설정 때문에 3000포트에서) 백엔드로의 요청이 허용됌

토큰수신
FcmController.java
/api/fcm/saver-token 엔드포인ㅇ트가 POST요청을 받고 토큰을 추출함

DB저장/갱신 FcmDAO.java
fcmDao.saverOUpdate()가 실행됌 mapper-fcm.xml에 정의된 sql 쿼리를 통해 postgresql에서 토큰을 저장하거나(insert) 이미 존재하면 갱신 시간(updated_at)만 업데이트(update)하여 토큰 생명주기를 관리함



### 푸쉬메시지 전송 및 수신과정

메시지 전송
백앤드 서버(spring boot)
백앤드 서버가 저장된 토큰을 사용하여 Firebase FCM 서버로 푸쉬 메시지 전송을 요청함, 해당 토큰이 등록된 클라이언트 브라우저의 Servcice Worker로 메시지를 라우팅합니다.

메시지 라우팅
Firebase FCM 서버(Google) 
FCM 서버는 토큰을 확인하고, 해당 토큰이 등록된 클라이언트 브라우저의 Service Worker로 메시지를 라우팅합니다.

firebase-messaging-sw.js
firebase-messaging-sw.js 브라우저가 닫혀 있거나 다른 탭에 있을때(백그라운드) 메시지를 받습니다. onBackgroundMessage 핸들러가 실행되어 OS 자체의 알림을 띄웁니다.

메시지 수신(포 그라운드)
App.vue
웹 앱이 활성화된 상태일 때 메시지를 받습니다. onMessage 핸들러가 실행되어 브라우저 내에서 사용자 정의 알림을 띄우거나, UI를 업데이트합니다.
















